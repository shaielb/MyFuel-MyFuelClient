package wrapper;

import java.util.ArrayList;
import java.util.Collection;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import action.ActionControl;
import action.FilterCapability;
import adapter.base.ControlAdapter;
import annotations.AutoGenerated;
import application.Main;
import client.IClient;
import controls.MfComboBox;
import controls.MfHyperlink;
import controls.MfImageView;
import controls.MfText;
import db.entity.FuelEnum;
import db.entity.Station;
import db.entity.StationManagerReports;
import db.entity.StationsFuel;
import db.interfaces.IEntity;
import javafx.fxml.FXMLLoader;
import javafx.scene.Parent;
import javafx.scene.Scene;
import javafx.scene.control.ComboBox;
import javafx.scene.control.Hyperlink;
import javafx.scene.image.ImageView;
import javafx.scene.text.Text;
import messages.QueryContainer;
import sceneswitch.Context;
import sceneswitch.SceneBase;

@AutoGenerated
public class InventoryReportScreen extends SceneBase {

	private StationManagerReports _stationManagerReports;
	private Station _station;
	private StationsFuel _stationsFuelSolerCurrentAmount;
	private FuelEnum _fuelEnum;
	private StationsFuel _stationsFuelMotorcycleCurrentAmount;
	private StationsFuel _stationsFuelBenzinCurrentAmount;

	private MfHyperlink _main_menu_managerControl;
	private MfImageView _mainMenuStationManagerScreenControl;
	private MfText _currentAmountControlSolerCurrentAmount;
	private MfText _currentAmountControlMotorcycleCurrentAmount;
	private MfText _reportDateControlTxt;
	private MfText _stationNameControl;
	private MfText _currentAmountControlBenzinCurrentAmount;
	private MfImageView _filterStationManagerReportsControl;
	private ActionControl _stationManagerReportsfilterAction;
	private MfComboBox _reportDateControlCmb;

	public InventoryReportScreen(ISceneSwitcher sceneSwitcher, IClient client, Context context) throws Exception {
		super(sceneSwitcher, client, context);
		initialize();
	}

	public void initialize() throws Exception {
		Parent root = FXMLLoader.load(Main.class.getResource("InventoryReportScreen.fxml"));
		_scene = new Scene(root);

		//scene switchers
		_main_menu_managerControl = new MfHyperlink((Hyperlink) _scene.lookup("#scene$main_menu_manager"));
		_main_menu_managerControl.addEvent((event) -> { _switcher.switchScene("main_menu_manager"); });

		_mainMenuStationManagerScreenControl = new MfImageView((ImageView) _scene.lookup("#scene$MainMenuStationManagerScreen"));
		_mainMenuStationManagerScreenControl.addEvent((event) -> { _switcher.switchScene("MainMenuStationManagerScreen"); });

		//entities instantiation
		_stationManagerReports = new StationManagerReports();
		_station = new Station();
		_stationsFuelSolerCurrentAmount = new StationsFuel();
		_fuelEnum = new FuelEnum();
		_stationsFuelMotorcycleCurrentAmount = new StationsFuel();
		_stationsFuelBenzinCurrentAmount = new StationsFuel();

		//entities assignments
		_stationManagerReports.setStation(_station);
		_stationsFuelSolerCurrentAmount.setStation(_station);
		_stationsFuelSolerCurrentAmount.setFuelEnum(_fuelEnum);
		_stationManagerReports.setFuelEnum(_fuelEnum);
		_stationsFuelMotorcycleCurrentAmount.setStation(_station);
		_stationsFuelMotorcycleCurrentAmount.setFuelEnum(_fuelEnum);
		_stationsFuelBenzinCurrentAmount.setStation(_station);
		_stationsFuelBenzinCurrentAmount.setFuelEnum(_fuelEnum);

		//controls instantiation
		_currentAmountControlSolerCurrentAmount = new MfText((Text) _scene.lookup("#table$station_manager_reports$station$stations_fuel$fuel_enum$$$soler$current_amount$$$txt"));
		_currentAmountControlMotorcycleCurrentAmount = new MfText((Text) _scene.lookup("#table$station_manager_reports$station$stations_fuel$fuel_enum$$$motorcycle$current_amount$$$txt"));
		_reportDateControlTxt = new MfText((Text) _scene.lookup("#table$station_manager_reports$report_date$$$txt"));
		_stationNameControl = new MfText((Text) _scene.lookup("#table$station_manager_reports$station$station_name"));
		_currentAmountControlBenzinCurrentAmount = new MfText((Text) _scene.lookup("#table$station_manager_reports$station$stations_fuel$fuel_enum$$$benzin$current_amount"));
		_reportDateControlCmb = new MfComboBox((ComboBox) _scene.lookup("#table$station_manager_reports$report_date$$$cmb"));

		//initializations
		_filterStationManagerReportsControl = new MfImageView((ImageView) _scene.lookup("#action$collect$station_manager_reports"));
		_stationManagerReportsfilterAction = new ActionControl();
		_stationManagerReportsfilterAction.setControl(_filterStationManagerReportsControl);
		FilterCapability stationManagerReportsFilterCapability = new FilterCapability();
		stationManagerReportsFilterCapability.setQueryContainers(prepareQuery(_stationManagerReports));
		_stationManagerReportsfilterAction.addCapability(stationManagerReportsFilterCapability);
		_stationManagerReportsfilterAction.setClient(_client);
		_stationManagerReportsfilterAction.setCallback((response) -> {
			Collection<IEntity> entities = response.getEntities();
			for (IEntity ientity : entities) {
				StationManagerReports entity = (StationManagerReports) ientity;
			}
		});

		//fields initializations
		_currentAmountControlSolerCurrentAmount.setField(_stationsFuelSolerCurrentAmount.getClass().getDeclaredField("_current_amount"));
		_currentAmountControlSolerCurrentAmount.setEntity(_stationsFuelSolerCurrentAmount);

		_currentAmountControlMotorcycleCurrentAmount.setField(_stationsFuelMotorcycleCurrentAmount.getClass().getDeclaredField("_current_amount"));
		_currentAmountControlMotorcycleCurrentAmount.setEntity(_stationsFuelMotorcycleCurrentAmount);

		_reportDateControlTxt.setField(_stationManagerReports.getClass().getDeclaredField("_report_date"));
		_reportDateControlTxt.setEntity(_stationManagerReports);

		_stationNameControl.setField(_station.getClass().getDeclaredField("_station_name"));
		_stationNameControl.setEntity(_station);

		_currentAmountControlBenzinCurrentAmount.setField(_stationsFuelBenzinCurrentAmount.getClass().getDeclaredField("_current_amount"));
		_currentAmountControlBenzinCurrentAmount.setEntity(_stationsFuelBenzinCurrentAmount);

		_reportDateControlCmb.setField(_stationManagerReports.getClass().getDeclaredField("_report_date"));
		_reportDateControlCmb.setEntity(_stationManagerReports);

		//grouping
		groupControls(new ControlAdapter[] { _reportDateControlTxt, _reportDateControlCmb });
		groupControls(new ControlAdapter[] { _currentAmountControlSolerCurrentAmount, _currentAmountControlMotorcycleCurrentAmount, _currentAmountControlBenzinCurrentAmount });

	}

	private List<QueryContainer> prepareQuery(StationManagerReports stationManagerReports) {
		List<QueryContainer> containers = new ArrayList<QueryContainer>();
		
		Map<String, String> queryMap = new HashMap<String, String>();
		
		QueryContainer container = new QueryContainer();
		container.setQueryEntity(stationManagerReports);
		container.setQueryMap(queryMap);
		containers.add(container);
		return containers;
	}

	public StationManagerReports getStationManagerReports() {
		 return _stationManagerReports;
	}

	public void setStationManagerReports(StationManagerReports stationManagerReports) {
		 _stationManagerReports = stationManagerReports;
	}

	public Station getStation() {
		 return _station;
	}

	public void setStation(Station station) {
		 _station = station;
	}

	public StationsFuel getStationsFuelSolerCurrentAmount() {
		 return _stationsFuelSolerCurrentAmount;
	}

	public void setStationsFuelSolerCurrentAmount(StationsFuel stationsFuelSolerCurrentAmount) {
		 _stationsFuelSolerCurrentAmount = stationsFuelSolerCurrentAmount;
	}

	public FuelEnum getFuelEnum() {
		 return _fuelEnum;
	}

	public void setFuelEnum(FuelEnum fuelEnum) {
		 _fuelEnum = fuelEnum;
	}

	public StationsFuel getStationsFuelMotorcycleCurrentAmount() {
		 return _stationsFuelMotorcycleCurrentAmount;
	}

	public void setStationsFuelMotorcycleCurrentAmount(StationsFuel stationsFuelMotorcycleCurrentAmount) {
		 _stationsFuelMotorcycleCurrentAmount = stationsFuelMotorcycleCurrentAmount;
	}

	public StationsFuel getStationsFuelBenzinCurrentAmount() {
		 return _stationsFuelBenzinCurrentAmount;
	}

	public void setStationsFuelBenzinCurrentAmount(StationsFuel stationsFuelBenzinCurrentAmount) {
		 _stationsFuelBenzinCurrentAmount = stationsFuelBenzinCurrentAmount;
	}
}
